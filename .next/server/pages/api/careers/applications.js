"use strict";(()=>{var e={};e.id=200,e.ids=[200],e.modules={2418:e=>{e.exports=require("mysql2/promise")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6705:e=>{e.exports=import("formidable")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},6137:(e,t,i)=>{i.a(e,async(e,a)=>{try{i.r(t),i.d(t,{config:()=>m,default:()=>p});var r=i(6705),s=i(3292),n=i.n(s),o=i(1017),l=i.n(o),c=i(2418),u=i.n(c),d=e([r]);r=(d.then?(await d)():d)[0];let m={api:{bodyParser:!1}};async function p(e,t){let{method:i,query:a}=e,s=await u().createConnection({host:"localhost",user:"root",password:"Govind@123",database:"ventleytechschema",port:3306});try{switch(i){case"GET":{let e=`SELECT a.*, j.title, j.location, j.mode
                            FROM applications a
                            LEFT JOIN w2_jobs j ON a.jobId = j.id
                            WHERE 1=1`,i=[];a.jobId&&(e+=" AND a.jobId = ?",i.push(a.jobId)),a.status&&(e+=" AND a.status = ?",i.push(a.status)),e+=" ORDER BY a.createdAt DESC";let[r]=await s.execute(e,i);return await s.end(),t.status(200).json({success:!0,applications:r,count:r.length})}case"POST":let o=(0,r.default)({uploadDir:l().join(process.cwd(),"public","resumes"),keepExtensions:!0,maxFileSize:5242880});await n().mkdir(l().join(process.cwd(),"public","resumes"),{recursive:!0});let[c,u]=await new Promise((t,i)=>{o.parse(e,(e,a,r)=>{e&&i(e),t([a,r])})}),d=null;if(u.resume){let e=Array.isArray(u.resume)?u.resume[0]:u.resume,t=Date.now(),i=`${t}-${e.originalFilename}`,a=l().join(process.cwd(),"public","resumes",i);await n().rename(e.filepath,a),d=`/resumes/${i}`}let p=e=>Array.isArray(e)?e[0]:e,m={id:"App-"+p(c.jobId),jobId:p(c.jobId),jobTitle:p(c.jobTitle),fullName:p(c.fullName),contactNumber:p(c.contactNumber),email:p(c.email),location:p(c.location),visaStatus:p(c.visaStatus),totalExperience:p(c.totalExperience),relevantExperience:p(c.relevantExperience),skills:p(c.skills),certifications:p(c.certifications)||"",education:p(c.education),linkedinProfile:p(c.linkedinProfile)||"",joiningAvailability:p(c.joiningAvailability),day1Onsite:p(c.day1Onsite),interviewAvailability:p(c.interviewAvailability),resumePath:d},f=`INSERT INTO applications (id,jobId, jobTitle, fullName, contactNumber, email, location, visaStatus, totalExperience,
                          relevantExperience, skills, certifications, education, linkedinProfile, joiningAvailability, day1Onsite, interviewAvailability, resumePath)
                            VALUES (?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,b=Object.values(m);return await s.execute(f,b),await s.end(),t.status(201).json({success:!0,application:m});default:return t.setHeader("Allow",["GET","POST"]),t.status(405).json({success:!1,error:`Method ${i} Not Allowed`})}}catch(e){return console.error("API Error:",e),t.status(500).json({success:!1,error:"Internal Server Error",message:e.message})}finally{await s.end()}}a()}catch(e){a(e)}})},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},5284:(e,t,i)=>{i.a(e,async(e,a)=>{try{i.r(t),i.d(t,{config:()=>u,default:()=>c,routeModule:()=>d});var r=i(1802),s=i(7153),n=i(6249),o=i(6137),l=e([o]);o=(l.then?(await l)():l)[0];let c=(0,n.l)(o,"default"),u=(0,n.l)(o,"config"),d=new r.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/careers/applications",pathname:"/api/careers/applications",bundlePath:"",filename:""},userland:o});a()}catch(e){a(e)}})},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=5284);module.exports=i})();